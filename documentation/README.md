# Model documentation


## Overview

There are two base models:
- The `1 region` model has only one region, in which demand (generated by a mixture of baseload, peaking and wind technologies) must match supply, allowing unmet demand at high cost.
- The `6 region` model has six regions. Electricity may be generated and transmitted across the regions according to a transmission topology, taken from the *IEEE 6-bus test system*.

For each of the two base models, there are 4 customisable inputs/settings that change the model's behaviour. They are:
- `ts_data`: the time series 
- `run_mode`: The models may be run in two modes:
  - `plan`: generation and transmission capacities are determined by minimising system (sum of installation and generation) costs.
  - `operate`: generation and transmission capacities are fixed and the system is operated to match supply and demand at minimum cost.
- `baseload_integer`: if `False`, baseload may be built to any nonnegative capacity (i.e. a continuous variable). If `True`, baseload may be built only in blocks of 3GW, which makes a model in `plan` mode a mixed-integer linear program and slower to solve. This switch matters only in `plan` mode, since in `operate` mode the capacities are user-defined.
- `baseload_ramping`: if `False` baseload generation can change at any rate. If `True`, baseload generation can only ramp up or down at 20% of its installed capacity per hour.




| Bus | Demand / candidate generation |
| ---:| ----------------------------- | 
| 1   | baseload, peaking             |
| 2   | demand (DE), wind (DE)        |
| 3   | baseload, peaking             |
| 4   | demand (FR)                   |
| 5   | demand (UK), wind (UK)        |
| 6   | baseload, peaking, wind (ES)  |


<img style="float: right;" src="6_region_diagram.jpg" alt="drawing" width="540" height="450">


| Technology | Installation cost <br> (£m/GWyr) | Generation cost <br> (£m/GWh) | Carbon Emissions <br> (t CO2/GWh) |
| -- | -- | -- | -- |
| Baseload     | 300 | 0.005 | 200 |
| Peaking      | 100 | 0.035 | 400 |
| Wind         | 100 |     0 |   0 |
| Unmet demand |   0 |     6 |   0 |



\begin{figure}
  \begin{tabular}{c}
    \includegraphics[scale=0.7, trim=10 10 10 10, clip]{model_diagram.pdf}
  \end{tabular}
  \begin{tabular}{ l  c}
  Bus & Demand/candidate generation \\ \hline
  1 & baseload, peaking \\
  2 & demand (DE), wind (DE) \\
  3 & baseload, peaking \\
  4 & demand (FR) \\
  5 & demand (UK), wind (UK) \\
  6 & baseload, peaking, wind (ES) \\ \hline
\end{tabular}
  \caption{6-bus model configuration. Demand must be met at buses 2, 5 and 6. Conventional generation (baseload or peaking) may be installed at buses 1, 3 and 6. Wind generation may be installed at buses 2, 5 and 6. Buses 2, 4, 5 and 6 use (demand or wind) time series data from Germany (DE), France (FR), the United Kingdom (UK) and Spain (ES) respectively.}
  \label{fig:model_2:model_diagram}
\end{figure}





\section{Appendix}
\label{sec:appendix}

\begin{table}
  \centering
  \small
\begin{tabular}{r p{5.0cm}}
  Term & Description \\ \hline
  \multicolumn{2}{l}{\textbf{Indices}} \\
  $i$ & Generation technology \\
  $r$ , $r'$ & Region \\
  $t$ & Time step \\
  \multicolumn{2}{l}{\textbf{Sets}} \\
  $\mathcal{I}$ & Technologies: baseload ($b$), peaking ($p$), wind ($w$), unmet demand ($u$) \\
  $\mathcal{D}$ & Decision variables \\
  \multicolumn{2}{l}{\textbf{Parameters}} \\
  $C_{i}^\text{gen}$ & Install cost, technology $i$ (\pounds m/GWyr)\\
  $C_{r, r'}^\text{tr}$ & Install cost, transmission, region $r$ to $r'$ (\pounds m/GWyr) \\
  $F_{i}^\text{gen}$ & Generation cost, technology $i$ (\pounds m/GWh) \\ \hline
\end{tabular} \hspace{0.5em}
\begin{tabular}{r p{3.7cm}}
  Term & Description \\ \hline
  \multicolumn{2}{l}{\textbf{Time series}} \\
  $d_{r, t}$ & Demand, region $r$, time step $t$ (GWh) \\
  $w_{r, t}$ & Wind capacity factor, region $r$, time $t$ ($\in$ [0, 1]) \\
  \multicolumn{2}{l}{\textbf{Decision variables}} \\
  $\text{cap}_{i, r}^\text{gen}$ & Generation capacity, technology $i$, region $r$ (GW) \\
  $\text{cap}_{r, r'}^\text{tr}$ & Transmission capacity, region $r$ to $r'$ (GW) \\
  $\text{gen}_{i, r, t}$ & Generation, technology $i$, region $r$, time $t$ (GWh) \\
  $\text{tr}_{r, r', t}$ & Transmission, region $r$ to region $r'$, time $t$ (GWh) \\ \hline
\end{tabular}
\caption{Nomenclature.}
\label{table:appendix:nomenclature}
\end{table}




\subsection{Mathematical formulation of test case power system models}
\label{sec:appendix:optimisation}

The three test PSMs determine outputs by solving the following optimisation problems.

\subsubsection{1-region LP}
\label{sec:appendix:optimisation:model_1}
\hspace{0.5em}

\begin{equation}
\min \Bigg[ \frac{T}{8760} \Bigg( \underbrace{\sum_{i \in \mathcal{I}} C_i^\text{gen} \text{cap}_{i,1}^\text{gen}}_{\substack{\text{installation cost,} \\ \text{generation capacity}}} \Bigg) + \underbrace{ \sum_{i \in \mathcal{I}} \sum_{t=1}^{T} F_i^\text{gen} \text{gen}_{i,1,t}}_\text{generation cost} \Bigg]
\label{eq:model_1:objective}
\end{equation}
\noindent by optimising over decision variables
\begin{equation}
  \mathcal{D} = \{\text{cap}_{i,r}^\text{gen}, \text{gen}_{i,r,t} \hspace{0.5em} : \hspace{0.5em} i \in \mathcal{I}; \hspace{0.5em} t = 1 \ldots T\} \label{eq:model_1:decision_variables} \\
\end{equation}
subject to
\begin{align}
\sum_{i \in \mathcal{I}} \text{gen}_{i,1,t} = d_{1,t} \quad & \forall \: t \label{eq:model_1:demand_met} \\
\text{gen}_{b,1,t} \le \text{cap}_{b,1}^\text{gen} \quad & \forall \: t \label{eq:model_1:gen_le_cap_b} \\
\text{gen}_{p,1,t} \le \text{cap}_{p,1}^\text{gen} \quad & \forall \: t \label{eq:model_1:gen_le_cap_p} \\
\text{gen}_{w,1,t} \le \text{cap}_{w,r}^\text{gen} w_{1,t} \quad & \forall \: t \label{eq:model_1:gen_le_cap_w} \\
\text{cap}_{i,1}^\text{gen}, \text{gen}_{i,1,t} \ge 0 \quad & \forall \: i, t. \label{eq:model_1:ge_0}
\end{align}

\noindent \eqref{eq:model_1:demand_met} is the demand balance requirement (allowing unmet demand). \eqref{eq:model_1:gen_le_cap_b}-\eqref{eq:model_1:gen_le_cap_w} ensure generation does not exceed installed capacity (for conventional technologies) or installed capacity times the wind capacity factor (for wind).


\subsubsection{6-region LP}
\label{sec:appendix:optimisation:model_2}

Model 2 is identical to Model 3 without integer and ramping constraints. Hence, it solves (\ref{eq:model_3:objective})-(\ref{eq:model_3:ge_0}) but \textbf{without} necessarily satisfying (\ref{eq:model_3:ramping}) and (\ref{eq:model_3:integer}).


\subsubsection{6-region MILP}
\label{sec:appendix:optimisation:model_3}
\begin{equation}
\min \sum_{r \in \mathcal{R}} \Bigg[ \frac{T}{8760} \Bigg( \underbrace{\sum_{i \in \mathcal{I}} C_i^\text{gen} \text{cap}_{i,r}^\text{gen}}_{\substack{\text{installation cost,} \\ \text{generation capacity}}} + \underbrace{ \frac{1}{2} \sum_{r' \in \mathcal{R}} C_{r,r'}^\text{tr} \text{cap}_{r,r'}^\text{tr} }_{\substack{\text{installation cost,} \\ \text{transmission capacity}}} \Bigg) + \underbrace{ \sum_{i \in \mathcal{I}} \sum_{t=1}^{T} F_i^\text{gen} \text{gen}_{i,r,t}}_\text{generation cost} \Bigg]
\label{eq:model_3:objective}
\end{equation}
by optimising over decision variables
\begin{equation}
\{\text{cap}_{i,r}^\text{gen}, \text{cap}_{r,r'}^\text{tr}, \text{gen}_{i,r,t}, \text{tr}_{r,r',t} \hspace{0.5em} : \hspace{0.5em} i \in \mathcal{I}; \hspace{0.5em} r,r' \in \mathcal{R}; \hspace{0.5em} t = 1 \ldots T\}
\label{eq:model_3:decision_variables}
\end{equation}
\noindent subject to
\begin{align}
\text{cap}_{b,r}^\text{gen} \big\rvert_{r \ne 1, 3, 6} = \text{cap}_{p,r}^\text{gen} \big\rvert_{r \ne 1, 3, 6} = \text{cap}_{w,r}^\text{gen} \big\rvert_{r \ne 2, 5, 6} &= 0 \label{eq:model_3:gen_topology} \\
\text{cap}_{r, r'}^\text{tr} \big\rvert_{\{r, r'\} \ne \{1,2\}, \{1,5\}, \{1,6\}, \{2,3\}, \{3,4\}, \{4,5\}, \{5,6\}} &= 0 \label{eq:model_3:tr_topology} \\
\sum_{i \in \mathcal{I}} \text{gen}_{i,r,t} + \sum_{r'=1}^6 \text{tr}_{r',r,t} = d_{r,t} \quad & \forall \: r, t \label{eq:model_3:demand_met} \\
\text{tr}_{r,r',t} + \text{tr}_{r,'r,t} = 0 \quad & \forall \: r, r', t \label{eq:model_3:tr_balance} \\
\text{gen}_{b,r,t} \le \text{cap}_{b,r}^\text{gen} \quad & \forall \: r, t \label{eq:model_3:gen_le_cap_b} \\
\text{gen}_{p,r,t} \le \text{cap}_{p,r}^\text{gen} \quad & \forall \: r, t \label{eq:model_3:gen_le_cap_p} \\
\text{gen}_{w,r,t} \le \text{cap}_{w,r}^\text{gen} w_{r,t} \quad & \forall \: r, t \label{eq:model_3:gen_le_cap_w} \\
|\text{gen}_{b,r,t} - \text{gen}_{b,r,t+1}| \le 0.2 \text{cap}_{b,r}^\text{gen} \quad & \forall \: r, t \label{eq:model_3:ramping} \\
\text{cap}_{b,r}^\text{gen} \in 3\mathbb{Z} \quad & \forall \: r \label{eq:model_3:integer} \\
|\text{tr}_{r,r',t}| \le \text{cap}_{r,r'}^\text{tr} \quad & \forall \: r, r', t \label{eq:model_3:tr_le_cap_tr} \\
\text{cap}_{i,r}^\text{gen}, \text{cap}_{r,r'}^\text{tr}, \text{gen}_{i,r,t} \ge 0 \quad & \forall \: i, r, t. \label{eq:model_3:ge_0}
\end{align}
\noindent \eqref{eq:model_3:gen_topology}-\eqref{eq:model_3:tr_topology} stipulate the locations of generation technologies and the model's transmission topology. \eqref{eq:model_3:demand_met} and \eqref{eq:model_3:tr_balance} are the demand and power flow balance requirements. \eqref{eq:model_3:gen_le_cap_b}-\eqref{eq:model_3:gen_le_cap_w} ensure generation does not exceed installed capacity (for conventional technologies) or installed capacity times the wind capacity factor (for wind). \eqref{eq:model_3:ramping} is the baseload ramping constraint. \eqref{eq:model_3:integer} enforces that baseload is built in 3GW units. \eqref{eq:model_3:tr_le_cap_tr} caps transmitted power at installed transmission capacity.












In this section the BUQ algorithm is applied to three test PSMs. Time series inputs are hourly demand levels and wind capacity factors in European countries over the 38-year period from 1980 to 2017. Model outputs consist of the minimum ``build-from-scratch'' power system cost as well as the associated carbon emissions, generation capacities and generation levels. The goal is to estimate each output's standard deviation using the BUQ algorithm introduced in Section \ref{sec:methodology}. The models are not intended to be realistic representation of existing power systems but serve as test cases containing many features of real power grids.

The remainder of this section is structured as follows. Section \ref{sec:results:overview} introduces the three test-case PSMs. Section \ref{sec:results:subsampling} discusses the subsampling scheme used to make bootstrap samples in step 1 of the BUQ algorithm (Section \ref{sec:methodology:overview}). Section \ref{sec:results:verification} provides evidence for the methodology's accuracy. Section \ref{sec:results:estimating_standard deviation} provides a case study of application of the BUQ algorithm in four settings.


\subsubsection{Model 1: 1-region LP}
\label{sec:results:model_1}

The \textit{1-region LP} model is a simple linear programming (LP)-based generation expansion planning (GEP) model with a choice of three possible generation technologies: \textit{baseload}, \textit{peaking} and \textit{wind}. Unmet demand (or, equivalently, load shedding) is allowed at high cost. The model takes two input time series: hourly demand levels and wind capacity factors for the United Kingdom. Section \ref{sec:appendix:optimisation:model_1} describes the precise mathematical optimisation problem.


\subsubsection{Model 2: 6-region LP}
\label{sec:results:model_2}



The \textit{6-region LP} is a more complicated multi-region generation \& transmission expansion planning (GEP/TEP) problem. The same technologies (baseload, peaking and wind) as in the \textit{1-region LP} are permitted, and unmet demand/load shedding is allowed at high cost. The system's 6-region topology is based on the \textit{IEEE 6-bus system}, see e.g.\ \citep{rau_1994, roh_2009, zhi_chen_2015, baharvandi_2018}. The available technologies at each bus are based on a renewables-ready version of the 6-bus system introduced by \citet{kamalinia_2010} and \citet{kamalinia_2011}. Figure \ref{fig:model_2:model_diagram} provides a diagram of the model configuration. Full mathematical details of the model are provided in Section \ref{sec:appendix:optimisation:model_2}.

The \textit{6-region LP} model returns a larger number of outputs than the \textit{1-region LP} since each output is at regional level (e.g. baseload in regions 1, 3 and 6) and transmission expansion is also considered. This induces nonuniqueness in the solution; for example, in the case of residual demand in region 2, the optimal solution has no preference in meeting this from extra generation and transmission from region 1 versus 3. This property can be removed by considering distinct technologies at each region. However, in the interest of simplicity, this investigation concentrates on model-wide outputs (e.g. total baseload capacity), which are unique given identical input data.


\subsubsection{Model 3: 6-region MILP}
\label{sec:results:model_3}

The \textit{6-region MILP} model is identical to the \textit{6-region LP} model with added integer and ramping constraints. Baseload generation capacity may be installed in blocks of 3GW (roughly a large nuclear plant) and is subject to a ramp rate of 20\%/hr. The optimisation problem is hence a mixed integer linear program (MILP) with ramping constraints. Mathematica deatils are provided in Section \ref{sec:appendix:optimisation:model_3}. 


\subsubsection{Computational cost and time series length}
\label{sec:results:computational_cost}

\begin{figure}
  \hspace*{3.5em} (a) 1-region LP \hspace*{4.5em} (b) 6-region LP \hspace*{4.3em} (c) 6-region MILP \\
  \includegraphics[scale=0.7, trim=10 10 0 0, clip]{cc_scaling/1region_cont.pdf}
  \includegraphics[scale=0.7, trim=20 10 0 0, clip]{cc_scaling/6regions_cont.pdf}
  \includegraphics[scale=0.7, trim=20 10 10 0, clip]{cc_scaling/6regions_disc.pdf}
  \center{\includegraphics[scale=0.7, trim=0 0 0 0, clip]{cc_scaling/legend.pdf}}
  \caption{Distribution (across 80 runs) of computational cost required to solve each of the 3 test PSMs as a function of sample size. The black line shows the median and the grey region indicates a 95\% symmetric prediction interval.}
  \label{fig:model_1:cc_scaling}
\end{figure}

Figure \ref{fig:model_1:cc_scaling} shows the distribution of the computing time to solve each model's optimisation problem as a function of the input demand \& weather time series length. For the \textit{1-region LP} model, solution times scale roughly linearly and 1-year simulations take 20-40 seconds. For the \textit{6-region LP} model, solution times are longer and scale up linearly at first but then accelerate in computational cost; a 5-year simulation (not shown) takes 1 hour, much longer than 5 times the 3-minute median for 1-year simulations. Furthermore, the range in solution times across runs using the same time series lengths is large. For the \textit{6-region MILP} model, the integer constraints cause an exponential scaling of solution times, which roughly double for every 72-day increase in sample length. Each of the above results are based on optimisation problems created in the open-source energy modeling framework \texttt{Calliope} \citep{pfenninger_2018} and solved using the \texttt{gurobi} solver on a 2.7GHz Intel Core i5-5257U processor with 8GB of RAM.











\subsection{Generation \& transmission technology characteristics}
\label{sec:appendix:generation_transmission_characteristics}

\begin{table}
  \centering
\begin{tabular}{ l  c  c  c}
\small
& Installation cost & Generation cost & Carbon emissions\\
Technology &(\pounds m/GWyr) &(\pounds m/GWh) & (t CO$_2$/GWh) \\ \hline
\multicolumn{4}{c}{\textbf{Generation technologies}} \\  
Baseload & $C_b^\text{gen} = 300$ & $F_b^\text{gen} = 0.005$ & $e_b = 200$ \\
Peaking & $C_p^\text{gen} = 100$ & $F_p^\text{gen} = 0.035$ & $e_m = 400$ \\
Wind & $C_w^\text{gen} = 100$ & $F_w^\text{gen} = 0$ & $e_w = 0$ \\
Unmet demand & $C_u^\text{gen} = 0$ & $F_u^\text{gen} = 6$ & $e_u = 0$ \\
\multicolumn{4}{c}{\textbf{Transmission technologies}} \\  
Regions 1 to 5 & $C_{1,5}^\text{tr} = 150$ & - & - \\
Other links & $C_{r,r'}^\text{tr} = 100$ & - & - \\ \hline
\end{tabular} \vspace{1em}
\caption{Costs and carbon emissions of generation and transmission technologies. Transmission costs consist only of installation costs. Installation costs are annualised so as to reflect cost per year of plant lifetime.}
\label{table:appendix:tech_characteristics}
\end{table}

\textit{Peaking} technology is based on a UK CCGT H class reactor described by \citep{beis_2016}, with build cost \pounds100/kW per year of plant lifetime, wholesale gas price of 2 pence per kWh, generation efficiency 55\% and carbon emissions of 400 grams of CO$_2$ equivalent per KWh \citep{electric_insights}. \textit{Baseload} and \textit{wind} technologies are based on the eponymous technologies in \citep{hilbers_2019}. Unmet demand is considered, for modeling purposes, a fourth technology with no installation cost but a generation cost of \pounds6,000/MWh = \pounds6m/GWh, used in some industrial applications as the value of lost load in the UK \citep{elexon_2015}. All transmission lines have an identical install price of \pounds100m/GW per year of plant lifetime, except the diagonal line from bus/region 1 to 5 with a 50\% higher cost. Transmission through installed lines is assumed free and without energy loss.




\subsection{Time series inputs}
\label{sec:appendix:time_series}

The time series are country-aggregated hourly demand levels and wind capacity factors for different European countries over the period 1980-2017. Details can be found in \citep{bloomfield_2019}.




\subsection{Open-source models, data and code}
\label{sec:appendix:code}

The models, data and sample code applying the BUQ algorithm are provided as open-source software at \url{github.com/ahilbers/2020_bootstrap_uncertainty_quantification}.

